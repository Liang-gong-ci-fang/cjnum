# lapack包残留问题

#### dlaqr1

**问题**

测试在第64行存在精度误差无法通过

**分析**

其一，发现将测试中的第11行随机数移动到循环内的第14行可通过测试，但是这样会导致测试不完整，比如，随机数在循环外时测试的随机数是1， 6， 3， 7， 8， 9，但是将随机数放在循环外之后是测试了两次1， 6， 3，（这些数字只是一个举例，具体数据参考测试代码），所以这样做并不能保证代码完全正确。

其二，因为问题出在数据的精度上，所以找到源文件中修改了数据的代码第，如下：

```cangjie
...
let h21s = h[ldh] / s
v[0] = h21s * h[1] + (h[0] - sr1) * ((h[0] - sr2) / s) - si1 * (si2 / s)
v[1] = h21s * (h[0] + h[ldh + 1] - sr1 - sr2)
...
...
let h21s = h[ldh] / s
let h31s = h[2*ldh] / s
v[0] = (h[0] - sr1) * ((h[0] - sr2) / s) - si1 * (si2 / s) + h[1] * h21s + h[2] * h31s
v[1] = h21s * (h[0] + h[ldh + 1] - sr1 - sr2) + h[ldh + 2] * h31s
v[2] = h31s * (h[0] + h[2 * ldh + 2] - sr1 - sr2) + h21s * h[2 * ldh + 1]
...
```

将修改v中的值时使用的**/s**用乘除法分配律统一移动到括号外之后可以通过测试，虽然通过测试，但是仓颉与go中这些数据均为64位，go在进行相同的计算时却不会导致精度问题，因此这里需要继续分析。
